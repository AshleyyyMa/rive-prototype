<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rive Interactive Prototype</title>
  <script src="https://unpkg.com/@rive-app/canvas"></script>
  <script src="https://unpkg.com/@rive-app/canvas@2.24.0"></script>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #f5f5f5;
    }
    canvas {
      width: 400px;
      height: 400px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="riveCanvas" width="400" height="400"></canvas>

  <script>
    const RIVE_SRC = "ace_test.riv"; // Replace with your .riv file path or URL
    const VIEW_MODEL_NAME = "View Model 1"; // Replace with your ViewModel name
    const INSTANCE_NAME = "Default"; // Replace with your instance name if needed

    const riveAnim = new rive.Rive({
      src: RIVE_SRC,
      canvas: document.getElementById("riveCanvas"),
      autoplay: true,
      stateMachines: [],
      autoBind: false,
      onLoad: () => {
        console.log("âœ… Rive loaded");
        setupBinding();
      },
      onLoadError: (err) => {
        console.error("Failed to load Rive:", err);
      }
    });

    let viewModelInstance = null;

    function setupBinding() {
      const vm = riveAnim.viewModelByName(VIEW_MODEL_NAME);
      if (!vm) {
        console.error("View model not found:", VIEW_MODEL_NAME);
        return;
      }

      viewModelInstance = vm.instanceByName(INSTANCE_NAME) || vm.defaultInstance();
      if (!viewModelInstance) {
        console.error("View model instance not found:", INSTANCE_NAME);
        return;
      }

      riveAnim.bindViewModelInstance(viewModelInstance);
      console.log("Bound VM instance:", viewModelInstance);
    }

    function prop(name) {
      if (!viewModelInstance) {
        console.warn("No viewModelInstance available yet");
        return null;
      }
      if (viewModelInstance.boolean) {
        return viewModelInstance.boolean(name);
      }
      if (viewModelInstance.trigger) {
        return viewModelInstance.trigger(name);
      }
      if (viewModelInstance.number) {
        return viewModelInstance.number(name);
      }
      if (viewModelInstance.enum) {
        return viewModelInstance.enum(name);
      }
      return viewModelInstance.property(name);
    }

    const canvas = document.getElementById("riveCanvas");
    canvas.addEventListener("mouseenter", () => {
      const p = prop("isHover");
      if (p && "value" in p) {
        p.value = true;
      }
    });
    canvas.addEventListener("mouseleave", () => {
      const p = prop("isHover");
      if (p && "value" in p) {
        p.value = false;
      }
    });
    canvas.addEventListener("click", () => {
      const p = prop("Click");
      if (p && typeof p.trigger === "function") {
        p.trigger();
      } else if (p && typeof p.value !== "undefined") {
        p.value = true;
      }
    });
  </script>
</body>
</html>
